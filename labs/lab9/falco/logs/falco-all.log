2025-11-16T16:22:21+0000: Falco version: 0.42.1 (x86_64)
2025-11-16T16:22:21+0000: Falco initialized with configuration files:
2025-11-16T16:22:21+0000:    /etc/falco/config.d/falco.container_plugin.yaml | schema validation: ok
2025-11-16T16:22:21+0000:    /etc/falco/config.d/falco.iso8601_timeformat.yaml | schema validation: ok
2025-11-16T16:22:21+0000:    /etc/falco/falco.yaml | schema validation: ok
2025-11-16T16:22:21+0000: System info: Linux version 6.13.8-arch1-1 (linux@archlinux) (gcc (GCC) 14.2.1 20250207, GNU ld (GNU Binutils) 2.44) #1 SMP PREEMPT_DYNAMIC Sun, 23 Mar 2025 17:17:30 +0000
2025-11-16T16:22:21+0000: Loaded plugin 'container@0.4.1' from file /usr/share/falco/plugins/libcontainer.so
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'podman' container engine.
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/podman/podman.sock'
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'docker' container engine.
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/var/run/docker.sock'
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'cri' container engine.
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/containerd/containerd.sock'
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/crio/crio.sock'
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/k3s/containerd/containerd.sock'
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/host-containerd/containerd.sock'
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'containerd' container engine.
2025-11-16T16:22:21+0000: [libs]: container: * enabled container runtime socket at '/host/run/host-containerd/containerd.sock'
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'lxc' container engine.
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'libvirt_lxc' container engine.
2025-11-16T16:22:21+0000: [libs]: container: Enabled 'bpm' container engine.
2025-11-16T16:22:21+0000: Loading rules from:
2025-11-16T16:22:21+0000:    /etc/falco/falco_rules.yaml | schema validation: ok
2025-11-16T16:22:21+0000:    /etc/falco/falco_rules.local.yaml | schema validation: none
2025-11-16T16:22:21+0000: The chosen syscall buffer dimension is: 8388608 bytes (8 MBs)
2025-11-16T16:22:21+0000: Starting health webserver with threadiness 24, listening on 0.0.0.0:8765
2025-11-16T16:22:21+0000: Loaded event sources: syscall
2025-11-16T16:22:21+0000: Enabled event sources: syscall
2025-11-16T16:22:21+0000: Opening 'syscall' source with modern BPF probe.
2025-11-16T16:22:21+0000: One ring buffer every '2' CPUs.
2025-11-16T16:22:21+0000: [libs]: Trying to open the right engine!
2025-11-16T16:22:23+0000: [libs]: libbpf: failed to determine tracepoint 'syscalls/sys_enter_connect' perf event ID: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libbpf: prog 'connect_e': failed to create tracepoint 'syscalls/sys_enter_connect' perf event: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libpman: failure while attaching TOCTOU mitigation program for 'connect' system call. Detection will continue to work, but TOCTOU mitigation may not properly work (errno: 2 | message: No such file or director
2025-11-16T16:22:23+0000: [libs]: libbpf: failed to determine tracepoint 'syscalls/sys_enter_creat' perf event ID: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libbpf: prog 'creat_e': failed to create tracepoint 'syscalls/sys_enter_creat' perf event: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libpman: failure while attaching TOCTOU mitigation program for 'creat' system call. Detection will continue to work, but TOCTOU mitigation may not properly work (errno: 2 | message: No such file or directory)
2025-11-16T16:22:23+0000: [libs]: libbpf: failed to determine tracepoint 'syscalls/sys_enter_open' perf event ID: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libbpf: prog 'open_e': failed to create tracepoint 'syscalls/sys_enter_open' perf event: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libpman: failure while attaching TOCTOU mitigation program for 'open' system call. Detection will continue to work, but TOCTOU mitigation may not properly work (errno: 2 | message: No such file or directory)
2025-11-16T16:22:23+0000: [libs]: libbpf: failed to determine tracepoint 'syscalls/sys_enter_openat2' perf event ID: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libbpf: prog 'openat2_e': failed to create tracepoint 'syscalls/sys_enter_openat2' perf event: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libpman: failure while attaching TOCTOU mitigation program for 'openat2' system call. Detection will continue to work, but TOCTOU mitigation may not properly work (errno: 2 | message: No such file or director
2025-11-16T16:22:23+0000: [libs]: libbpf: failed to determine tracepoint 'syscalls/sys_enter_openat' perf event ID: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libbpf: prog 'openat_e': failed to create tracepoint 'syscalls/sys_enter_openat' perf event: No such file or directory
2025-11-16T16:22:23+0000: [libs]: libpman: failure while attaching TOCTOU mitigation program for 'openat' system call. Detection will continue to work, but TOCTOU mitigation may not properly work (errno: 2 | message: No such file or directory
{"hostname":"90fd18a6c341","output":"2025-11-16T16:30:30.531192429+0000: Warning Sensitive file opened for reading by non-trusted program | file=/etc/pam.d/i3lock gparent=xss-lock ggparent=i3 gggparent=lightdm evt_type=openat user=<NA> user_uid=1000 user_loginuid=1000 process=i3lock proc_exepath=/usr/bin/i3lock parent=bash command=i3lock -i /tmp/i3lock.png terminal=0 container_id=host container_name=host container_image_repository= container_image_tag= k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"host","container.image.repository":"","container.image.tag":"","container.name":"host","evt.time.iso8601":1763310630531192429,"evt.type":"openat","fd.name":"/etc/pam.d/i3lock","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"xss-lock","proc.aname[3]":"i3","proc.aname[4]":"lightdm","proc.cmdline":"i3lock -i /tmp/i3lock.png","proc.exepath":"/usr/bin/i3lock","proc.name":"i3lock","proc.pname":"bash","proc.tty":0,"user.loginuid":1000,"user.name":"<NA>","user.uid":1000},"priority":"Warning","rule":"Read sensitive file untrusted","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-16T16:30:30.531192429Z"}
{"hostname":"90fd18a6c341","output":"2025-11-16T16:30:30.531201417+0000: Warning Sensitive file opened for reading by non-trusted program | file=/etc/pam.d/system-auth gparent=xss-lock ggparent=i3 gggparent=lightdm evt_type=openat user=<NA> user_uid=1000 user_loginuid=1000 process=i3lock proc_exepath=/usr/bin/i3lock parent=bash command=i3lock -i /tmp/i3lock.png terminal=0 container_id=host container_name=host container_image_repository= container_image_tag= k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"host","container.image.repository":"","container.image.tag":"","container.name":"host","evt.time.iso8601":1763310630531201417,"evt.type":"openat","fd.name":"/etc/pam.d/system-auth","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"xss-lock","proc.aname[3]":"i3","proc.aname[4]":"lightdm","proc.cmdline":"i3lock -i /tmp/i3lock.png","proc.exepath":"/usr/bin/i3lock","proc.name":"i3lock","proc.pname":"bash","proc.tty":0,"user.loginuid":1000,"user.name":"<NA>","user.uid":1000},"priority":"Warning","rule":"Read sensitive file untrusted","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-16T16:30:30.531201417Z"}
{"hostname":"90fd18a6c341","output":"2025-11-16T16:30:30.532663924+0000: Warning Sensitive file opened for reading by non-trusted program | file=/etc/pam.d/other gparent=xss-lock ggparent=i3 gggparent=lightdm evt_type=openat user=<NA> user_uid=1000 user_loginuid=1000 process=i3lock proc_exepath=/usr/bin/i3lock parent=bash command=i3lock -i /tmp/i3lock.png terminal=0 container_id=host container_name=host container_image_repository= container_image_tag= k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"host","container.image.repository":"","container.image.tag":"","container.name":"host","evt.time.iso8601":1763310630532663924,"evt.type":"openat","fd.name":"/etc/pam.d/other","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"xss-lock","proc.aname[3]":"i3","proc.aname[4]":"lightdm","proc.cmdline":"i3lock -i /tmp/i3lock.png","proc.exepath":"/usr/bin/i3lock","proc.name":"i3lock","proc.pname":"bash","proc.tty":0,"user.loginuid":1000,"user.name":"<NA>","user.uid":1000},"priority":"Warning","rule":"Read sensitive file untrusted","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-16T16:30:30.532663924Z"}
{"hostname":"90fd18a6c341","output":"2025-11-16T16:34:19.023422678+0000: Notice A shell was spawned in a container with an attached terminal | evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/bin/busybox parent=containerd-shim command=sh -lc echo \"shell test\"; sleep 1 terminal=34816 exe_flags=EXE_WRITABLE|EXE_LOWER_LAYER container_id=f4b0345df7ba container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"f4b0345df7ba","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.arg.flags":"EXE_WRITABLE|EXE_LOWER_LAYER","evt.time.iso8601":1763310859023422678,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.cmdline":"sh -lc echo \"shell test\"; sleep 1","proc.exepath":"/bin/busybox","proc.name":"sh","proc.pname":"containerd-shim","proc.tty":34816,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Notice","rule":"Terminal shell in container","source":"syscall","tags":["T1059","container","maturity_stable","mitre_execution","shell"],"time":"2025-11-16T16:34:19.023422678Z"}
{"hostname":"90fd18a6c341","output":"2025-11-16T16:34:39.139742223+0000: Warning Sensitive file opened for reading by non-trusted program | file=/etc/shadow gparent=containerd-shim ggparent=systemd gggparent=<NA> evt_type=open user=root user_uid=0 user_loginuid=-1 process=cat proc_exepath=/bin/busybox parent=sh command=cat /etc/shadow terminal=0 container_id=f4b0345df7ba container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"f4b0345df7ba","container.image.repository":null,"container.image.tag":null,"container.name":null,"evt.time.iso8601":1763310879139742223,"evt.type":"open","fd.name":"/etc/shadow","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"containerd-shim","proc.aname[3]":"systemd","proc.aname[4]":null,"proc.cmdline":"cat /etc/shadow","proc.exepath":"/bin/busybox","proc.name":"cat","proc.pname":"sh","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Warning","rule":"Read sensitive file untrusted","source":"syscall","tags":["T1555","container","filesystem","host","maturity_stable","mitre_credential_access"],"time":"2025-11-16T16:34:39.139742223Z"}
{"hostname":"90fd18a6c341","output":"2025-11-16T16:34:47.239585028+0000: Critical Executing binary not part of base image | proc_exe=/usr/sbin/update-ca-certificates proc_sname=apk gparent=apk proc_exe_ino_ctime=1763310886131455429 proc_exe_ino_mtime=2324016441436649984 proc_exe_ino_ctime_duration_proc_start=1107981038 proc_cwd=/ container_start_ts=1763310131756228746 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=update-ca-certi proc_exepath=/usr/sbin/update-ca-certificates parent=ca-certificates command=update-ca-certi terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=f4b0345df7ba container_name=<NA> container_image_repository=<NA> container_image_tag=<NA> k8s_pod_name=<NA> k8s_ns_name=<NA>","output_fields":{"container.id":"f4b0345df7ba","container.image.repository":null,"container.image.tag":null,"container.name":null,"container.start_ts":1763310131756228746,"evt.arg.flags":"EXE_WRITABLE|EXE_UPPER_LAYER","evt.time.iso8601":1763310887239585028,"evt.type":"execve","k8s.ns.name":null,"k8s.pod.name":null,"proc.aname[2]":"apk","proc.cmdline":"update-ca-certi","proc.cwd":"/","proc.exe":"/usr/sbin/update-ca-certificates","proc.exe_ino.ctime":1763310886131455429,"proc.exe_ino.ctime_duration_proc_start":1107981038,"proc.exe_ino.mtime":2324016441436649984,"proc.exepath":"/usr/sbin/update-ca-certificates","proc.name":"update-ca-certi","proc.pname":"ca-certificates","proc.sname":"apk","proc.tty":0,"user.loginuid":-1,"user.name":"root","user.uid":0},"priority":"Critical","rule":"Drop and execute new binary in container","source":"syscall","tags":["PCI_DSS_11.5.1","TA0003","container","maturity_stable","mitre_persistence","process"],"time":"2025-11-16T16:34:47.239585028Z"}
